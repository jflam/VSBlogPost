---
title: "Introducing R Tools for Visual Studio"
output: 
    html_document:
        theme: cosmo
        highlight: tango
---

[R is a programming language](https://www.r-project.org/) that is widely used by
data scientists, and developers seeking a more powerful tool to work with data.
While data scientists use R to write programs, their work product is rarely the
program itself. Instead, they produce reports or presentations from the results
generated by their R program to help influence or drive business decisions.

R Tools for Visual Studio (RTVS), currently available as a Public Preview
release, is a new tool from Microsoft for creating R programs using Visual
Studio. RTVS is free, and [Open Sourced under the MIT
license](https://github.com/microsoft/rtvs). It can be [downloaded by following
the instructions here](https://microsoft.github.io/RTVS-docs/installation.html),
and you can [read our documentation
here](https://microsoft.github.io/RTVS-docs/). 

If you prefer videos, I've created a video that walks you through the major
features of RTVS:

<iframe width="560" height="315" src="https://www.youtube.com/embed/KPS0ytrt9SA" frameborder="0" allowfullscreen></iframe>

## A Quick Tour of R

R is a [strong](https://en.wikipedia.org/wiki/Strong_and_weak_typing),
[dynamically typed](http://c2.com/cgi/wiki?DynamicTyping), interpreted language
that draws a lot of inspiration from other languages. It is a [functional
language](https://en.wikipedia.org/wiki/Functional_programming) that heavily
draws from [Scheme](https://en.wikipedia.org/wiki/Scheme_(programming_language))
and [S](https://en.wikipedia.org/wiki/S_(programming_language)). It is beyond
the scope of this blog post to discuss the semantics of the language, but I
strongly encourage you to read these two freely available online books for a
deep introduction to the language:

1. [Advanced R](http://adv-r.had.co.nz/)
1. [The R Inferno](http://www.burns-stat.com/documents/books/the-r-inferno/)

The remainder of this blog post is a quick tour of R, its packages, and RTVS
with the goal of inspiring you to learn more about the language, its packages,
and how it can be a useful addition to your toolbox for analyzing data. 

The quickest way to get started with R is through its [Read-Eval-Print Loop
(REPL)](https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop),
which lets you send commands *interactively* to the R interpreter. In RTVS, we
surface the R REPL through the R Interactive Window.

As you can see, you can type `3 + 4` and have the result immediately computed by
R; no compilation step necessary:

```{r comment = NULL}
3 + 4
```

R's strength is working with data. Therefore, it's not surprising that the most
heavily used data structure in R is the [R
dataframe](http://www.r-tutor.com/r-introduction/data-frame), which is a
convenient way of working with tabular datasets. There are many ways of
getting data into an R dataframe, but perhaps the easiest is to read it from a
URI. Below, you're reading a CSV file containing data about locations of
airports in the United States from GitHub: 

```{r}
usa_airports <- read.csv("https://raw.githubusercontent.com/jflam/VSBlogPost/master/usa_airports.dat", stringsAsFactors = TRUE)
```

In R, you assign variables using the `<-` operator, and you invoke functions
using parenthesis. So in the code above, you're invoking the `read.csv()` R
function, passing in the URI to the CSV file. 

You can get help on any R function by using the `?` operator from the
REPL. For example, to get help on the `read.csv` API, just type `?read.csv` in
the REPL.

Next, you're using another R function, `head()` to display a summary of the first
5 lines of the file:

```{r comment = NULL}
head(usa_airports)
```

The `head` function is fairly primitive, as it just generates text-based output.
That's not surprising since [R has been around since
1993](https://en.wikipedia.org/wiki/R_(programming_language)). Surely we can do
better in 2016? 

As it turns out, we can. There are a lot of packages in R that bind the R
programming language to the most powerful hardware-accelerated rendering
platform on the planet: HTML. In R, this is accomplished through a set of Open
Source packages known as [htmlwidgets for R](http://www.htmlwidgets.org/).
Below is the same dataframe rendered using the DataTable widget. We generate an
HTML page that contains all of the data from the usa_airports dataframe, and
open up a browser window using the default browser that shows an interactive
table containing the data. The data really is interactive; try typing "Seattle"
into the search box to see it filter the data to only airports in Seattle in
real time, or click on column headings to sort by that column. For that, we
will need the [DT](https://rstudio.github.io/DT/) package. 

However, we need to install the package before we can use it. Fortunately, R
makes very easy to install packages from the web. Just run the following
command: 

```
install.packages("DT")
```

And that's it. R will download and install the package automagically for you.
You can of course run `install.packages()` to install any packages. You can
even install more than one at once by using a vector, like this: 

```
install.packages(c("DT", "leaflet", "dplyr", "ggplot2", "ggvis", "rodbc"))
```

Now, we can proceed to use the package: 

```{r}
library(DT)
datatable(usa_airports[,c("name", "city", "country", "IATA_FAA", "lat", "lon", "altitude")])
```

If you prefer to manipulate your data programmatically, you can easily do so as
well. A popular package for manipulating data is the [dplyr package by Hadley
Wickham](https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html).
Let's say that we wanted to generate a list of airports located near New York
city. You can do this easily via the `subset` function from `dplyr`:

```{r message=FALSE}
library(dplyr)
new_york_airports <- filter(usa_airports, city == "New York")
datatable(new_york_airports[,c("name", "city", "country", "IATA_FAA", "lat", "lon", "altitude")])
```

You can also do more sophisticated filtering: e.g., select all the airports in
NYC at below 25 feet elevation, ordering the rows by altitude and selecting only
the name, altitude, latitude and longitude of the airport:

```{r}
low_nyc <- 
    usa_airports %>% 
	filter(city == "New York" & altitude < 25) %>% 
	arrange(altitude) %>% 
	select(name, altitude, lat, lon)
datatable(low_nyc)
```

Here, you see a more sophisticated use of R syntax via the `%>%` or "pipe"
operator. This operator lets you naturally compose operations and read them from
left to right. So in the above example, you take the `usa_airports` dataframe,
filtering all of the rows where the condition `city == "New York" & altitude <
25` holds true, sorting the rows by the `altitude` column, and selecting only
the columns `name`, `altitude`, `lat`, and `lon` for the result dataset which is
stored in the `low_nyc` variable.

If you're curious about the implementation of the pipe operator, see the
[magrittr](https://github.com/smbache/magrittr) package, as well as this
excellent blog post on how [magrittr was influenced by the forward pipe operator
from
F#](http://www.r-statistics.com/2014/08/simpler-r-coding-with-pipes-the-present-and-future-of-the-magrittr-package/).  

## Plotting data on maps

Once you have your dataset, you can plot it on an interactive map. The [leaflet
HtmlWidget](http://www.htmlwidgets.org/showcase_leaflet.html) is an excellent
package for generating interactive maps. In the code fragment below, you take
the dataframe that contains low altitude New York City airports that you
generated via `dplyr` in the previous step, and using the now-familiar pipe
operator send it to the `leaflet package`, asking it to generate map tiles and
plotting circles on them using the `lon` and `lat` columns for the positions of
the circles, and using the `name` column for the popup that appears when the
user clicks on a circle.

```{r fig.width=9.5, fig.height=5}
library(leaflet)
map <- 
    low_nyc %>% 
	leaflet() %>% 
	addTiles() %>% 
	addCircles(~lon, ~lat, popup = ~name, radius = 200, color="blue", opacity = 0.8)
map
```

## Wrapping up the tour

There is lots more to learn about R than I have time or space for in this blog
post. However, hopefully what I've done is whet your appetite to learn more
about R. There are many, many things that I haven't covered in this blog post,
so I've included a bunch of resources below to help you better understand R and
its packages. 

### Introduction to the R Programming Language 

1. [An Introduction to R](https://cran.r-project.org/doc/manuals/R-intro.pdf) is
   the official R Project introduction to the R language, and is written by
   [David Smith](https://twitter.com/revodavid), who currently works at
   Microsoft on the R team.

1. [R for Dummies](http://rfordummies.com/) is an introductory book on R,
   written by [Andrie de Vries](https://twitter.com/revoandrie), who currently
   works at Microsoft on the R team.

1. [Introduction to R
   Programming](https://www.edx.org/course/introduction-r-programming-microsoft-dat204x-1)
   is a free online class created by Microsoft to help you learn R.

### Key R Packages

1. [dplyr](https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html)
   is the data manipulation "d plyer" package that is a key tool for helping you
   quickly manipulate your data into a form that you can analyze.

1. [ggplot2](http://ggplot2.org/) is a plotting package that builds on the
   [grammar of graphics](http://vita.had.co.nz/papers/layered-grammar.pdf) ideas by Hadley Wickham

1. [ggvis](http://ggvis.rstudio.com/) is a plotting package that generates plots
   on an HTML canvas, using the same [grammar of
   graphics](http://vita.had.co.nz/papers/layered-grammar.pdf) semantics as
   ggplot2

1. [rodbc](https://cran.r-project.org/web/packages/RODBC/index.html) lets you
   read data from an ODBC compliant database like SQL Server

### Microsoft R products

Microsoft has a deep commitment to R, and provides a full-stack
R solution for your applications, complete with tooling, runtimes and packages.

1. [R Tools for Visual
   Studio](https://www.visualstudio.com/en-us/features/rtvs-vs.aspx/) is
   Microsoft's free, Open Source tooling for R development in Visual Studio.

1. [Microsoft R Open](https://mran.revolutionanalytics.com/open/) is Microsoft's
   cross-platform (Windows, OS X, Linux) distribution of R. It combines
   integration with [Intel's Math Kernel
   Library](https://software.intel.com/en-us/intel-mkl) for [accelerated linear
   algebra computations](https://mran.revolutionanalytics.com/rro/#intelmkl1),
   as well as integration with the [checkpoint
   package](https://cran.r-project.org/web/packages/checkpoint/index.html) to
   ensure that users of your R programs will be guaranteed to be able to run
   your R program [using the same version of the R
   packages](https://mran.revolutionanalytics.com/rro/#reproducibility) that
   you used to create it.

1. [Microsoft R
   Server](https://www.microsoft.com/en-us/server-cloud/products/r-server/) is
   Microsoft's packages for accelerated R computation on datasets that don't
   fit in system memory. It builds on top of the benefits of Microsoft R Open,
   and adds 

# One more thing ...

We've talked about a bunch of things in this brief blog post. However, perhaps
the coolest thing about this blog post is ... _I wrote it in Visual Studio_. The
document was written in [RMarkdown](http://rmarkdown.rstudio.com/), a dialect of
the popular [Markdown markup
language](https://daringfireball.net/projects/markdown/), which supports
embedding executable R code snippets within it.

If you want to look at the source code for it, you can [get it at my
GitHub](https://github.com/jflam/VSBlogPost).

![Light Theme Screenshot of
RTVS](https://rawgit.com/jflam/VSBlogPost/master/vs_blog_post_light.png)


**John Lam** is the Program Manager for R Tools for Visual Studio, Python Tools
for Visual Studio, and the Azure Jupyter Notebook Service. I work with an
awesome team of devs building tools for data scientists. You can reach me on
Twitter [\@john_lam](https://twitter.com/john_lam), or on
[GitHub](https://github.com/jflam/). Oh, and I have jobs for Python devs. Hit me
up at jflam@microsoft.com.
